<!DOCTYPE html>
<html lang="ru">
<head>
	<title>transfer</title>	
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="Cache-Control" content="no-cache">
<script src="https://unpkg.com/golos-js@0.7.0/dist/golos.min.js"></script>
</head>	
<h3>TRANSFER</h3>
<p><input type="textbox" id="userto" style="width:300px; height:25px" placeholder="null"> кому отправляем</p>
<p><input type="textbox" id="amount" style="width:300px; height:25px"> сколько отправить</p> 
<p><select id="select-token">
    <option disabled>Выберите токен</option>
    <option value="GBG">GBG</option>    
    <option value="GOLOS">GOLOS</option>     
</select> выберите GOLOS или GBG</p>
<p><input type="textbox" id="userfrom" style="width:300px; height:25px"> отправитель</p>
<p> !! ниже активный ключ отправителя(начинается с 5 ) !!</p>    
<p><input type="textbox" id="akey" style="width:500px; height:25px" placeholder="5 . . . . . . ."></p>
<p>сообщение получателю (memo, не обязательно)<br>
<b>не</b> стоит отправлять в memo активные и owner ключи, это <b>не</b> безопасно</p>
<p><input type="textbox" id="memo" style="width:500px; height:25px"></p> 
<p><input type="button" id="send" value="ОТПРАВИТЬ"style="width:120px; height:30px"></p>

<script>
// == INIT ==
golos.config.set('websocket','wss://ws.golos.io');
golos.config.set('address_prefix','GLS');
golos.config.set('chain_id','782a3039b478c839e4cb0c941ff4eaeb7df40bdd68bd441afd444b9da763de12');
//======= FUNCTION =========
// вспомогательные
ins2 = function(text, id){
//	вставим text в поле id (только для <input .. )
 document.getElementById(id).value = text; 
 } 
// ==== обработчик кнопки  id="send" 
document.getElementById('send').onclick = function() {
	var to     = document.getElementById("userto").value;//аккаунт кому отправляем
	var from   = document.getElementById("userfrom").value;//аккаунт отправитель
	var wif    = document.getElementById("akey").value;//активный ключ аккаунта отправителя
	var amount = document.getElementById("amount").value;//сколько отправить
	var token  = document.getElementById("select-token").value;//GOLOS или GBG
	var memo   = document.getElementById("memo").value;//
	amount = amount + ' ' + token;
	console.log(amount);
	console.log(memo);

//======= TRANSFER ============

golos.broadcast.transfer(wif, from, to, amount, memo, function(err, result) {
  //console.log(err, result);
  if (!err) {
    console.log('transfer', result);
    //console.log('expiration',result.expiration);
    //console.log('signatures',result.signatures[0]);
    //ins2('перевод выполнен ', 'transfers');
    document.getElementById('transfers').innerHTML = ('перевод выполнен ' + result.expiration);
    //document.getElementById('end').innerHTML = ('The END');
  }
  else console.error(err);
});
}
</script>
<hr>
<p id="transfers"><b>transfers:</b> </p>
<hr>
<!--h3 id="end">___</h3-->

</html>
